# Step 2: User Authentication System

## Overview
Implement simple user authentication with registration, login, and JWT token management for the keystroke verification platform.

## Requirements
- Create user registration endpoint with email/password validation
- Implement secure password hashing with bcrypt
- Build JWT token generation and validation middleware
- Create login endpoint with proper error handling
- Add user model with proper TypeScript types
- Implement protected route middleware for API
- Create basic auth context in React frontend
- Build registration and login forms with validation

## Technical Specifications
- Use bcrypt for password hashing with salt rounds of 12
- JWT tokens should expire in 7 days
- Email validation with proper regex
- Password requirements: min 8 chars, 1 uppercase, 1 lowercase, 1 number
- Store JWT in httpOnly cookie for security
- Add rate limiting for auth endpoints (5 attempts per minute)

## Implementation Prompt

```
Implement a simple authentication system for the Signify platform with registration, login, and JWT token management.

Backend requirements:
1. Authentication endpoints:
   - POST /auth/register - User registration with validation
   - POST /auth/login - User login with JWT response
   - POST /auth/logout - Clear authentication cookie
   - GET /auth/me - Get current user info (protected)

2. Security features:
   - bcrypt password hashing (12 salt rounds)
   - JWT tokens with 7-day expiration
   - httpOnly cookies for token storage
   - Rate limiting: 5 auth attempts per minute per IP
   - Input validation and sanitization

3. Validation rules:
   - Email: valid email format, unique in database
   - Password: min 8 chars, 1 uppercase, 1 lowercase, 1 number
   - Display name: 2-50 characters, no special chars

4. Middleware:
   - JWT authentication middleware for protected routes
   - Rate limiting middleware
   - Request validation middleware

Frontend requirements:
1. Authentication context:
   - React context for auth state management
   - Custom hooks: useAuth, useRequireAuth
   - Automatic token refresh handling
   - Login/logout state management

2. UI components:
   - Registration form with real-time validation
   - Login form with error handling
   - Protected route wrapper component
   - Loading states and error messages

3. Form validation:
   - Real-time email and password validation
   - User-friendly error messages
   - Form submission handling with loading states
   - Success/error notifications

Build all authentication components with proper TypeScript types, error handling, and user feedback. Include comprehensive validation on both frontend and backend. Keep the system simple and focused on core authentication without complex verification features.
```

## Deliverables
- POST /auth/register endpoint with validation
- POST /auth/login endpoint with JWT response
- Authentication middleware for protected routes
- React auth context and hooks
- Registration and login UI components
- Proper error handling and user feedback